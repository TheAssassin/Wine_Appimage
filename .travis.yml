sudo: required

language: cpp
services:
  - docker

before_install:
  # ubuntu bionic
  # - wget -nv -c https://dl.winehq.org/wine-builds/ubuntu/dists/bionic/main/binary-i386/wine-stable_4.0~bionic_i386.deb
  # - wget -nv -c https://dl.winehq.org/wine-builds/ubuntu/dists/bionic/main/binary-i386/wine-stable-i386_4.0~bionic_i386.deb
  # - wget -nv -c https://dl.winehq.org/wine-builds/ubuntu/dists/bionic/main/binary-i386/wine-devel_4.3~bionic_i386.deb
  # - wget -nv -c https://dl.winehq.org/wine-builds/ubuntu/dists/bionic/main/binary-i386/wine-devel-i386_4.3~bionic_i386.deb
  # - wget -nv -c https://dl.winehq.org/wine-builds/ubuntu/dists/bionic/main/binary-i386/wine-staging_4.3~bionic_i386.deb
  # - wget -nv -c https://dl.winehq.org/wine-builds/ubuntu/dists/bionic/main/binary-i386/wine-staging-i386_4.3~bionic_i386.deb

  # debian buster
  # - wget -nv -c https://dl.winehq.org/wine-builds/debian/dists/buster/main/binary-i386/wine-stable_4.0~buster_i386.deb
  # - wget -nv -c https://dl.winehq.org/wine-builds/debian/dists/buster/main/binary-i386/wine-stable-i386_4.0~buster_i386.deb
  # - wget -nv -c https://dl.winehq.org/wine-builds/debian/dists/buster/main/binary-i386/wine-devel_4.3~buster_i386.deb
  # - wget -nv -c https://dl.winehq.org/wine-builds/debian/dists/buster/main/binary-i386/wine-devel-i386_4.3~buster_i386.deb
  # - wget -nv -c https://dl.winehq.org/wine-builds/debian/dists/buster/main/binary-i386/wine-staging_4.3~buster_i386.deb
  # - wget -nv -c https://dl.winehq.org/wine-builds/debian/dists/buster/main/binary-i386/wine-staging-i386_4.3~buster_i386.deb

  # debian stretch
  # - wget -nv -c https://dl.winehq.org/wine-builds/debian/dists/stretch/main/binary-i386/wine-stable_4.0~stretch_i386.deb
  # - wget -nv -c https://dl.winehq.org/wine-builds/debian/dists/stretch/main/binary-i386/wine-stable-i386_4.0~stretch_i386.deb
  # - wget -nv -c https://dl.winehq.org/wine-builds/debian/dists/stretch/main/binary-i386/wine-devel_4.3~stretch_i386.deb
  # - wget -nv -c https://dl.winehq.org/wine-builds/debian/dists/stretch/main/binary-i386/wine-devel-i386_4.3~stretch_i386.deb
  # - wget -nv -c https://dl.winehq.org/wine-builds/debian/dists/stretch/main/binary-i386/wine-staging_4.3~stretch_i386.deb
  # - wget -nv -c https://dl.winehq.org/wine-builds/debian/dists/stretch/main/binary-i386/wine-staging-i386_4.3~stretch_i386.deb

  # archlinux
  - wget -nv -c https://www.playonlinux.com/wine/binaries/phoenicis/upstream-linux-x86/PlayOnLinux-wine-4.3-upstream-linux-x86.tar.gz

  # appimagetool
  - wget -nv -c "https://github.com/AppImage/AppImageKit/releases/download/continuous/appimagetool-x86_64.AppImage" -O  appimagetool.AppImage

script:
  # ubuntu bionic
  # - docker build . -f deploydocker/Dockerfile.wine-stable-deploy.bionic -t wine-stable-appimage.bionic
  # - docker build . -f deploydocker/Dockerfile.wine-devel-deploy.bionic -t wine-devel-appimage.bionic
  # - docker build . -f deploydocker/Dockerfile.wine-staging-deploy.bionic -t wine-staging-appimage.bionic

  # debian buster
  # - docker build . -f deploydocker/Dockerfile.wine-stable-deploy.buster -t wine-stable-appimage.buster
  # - docker build . -f deploydocker/Dockerfile.wine-devel-deploy.buster -t wine-devel-appimage.buster
  # - docker build . -f deploydocker/Dockerfile.wine-staging-deploy.buster -t wine-staging-appimage.buster

  # debian stretch
  # - docker build . -f deploydocker/Dockerfile.wine-stable-deploy.stretch -t wine-stable-appimage.stretch
  # - docker build . -f deploydocker/Dockerfile.wine-devel-deploy.stretch -t wine-devel-appimage.stretch
  # - docker build . -f deploydocker/Dockerfile.wine-staging-deploy.stretch -t wine-staging-appimage.stretch

  # archlinux
  - docker build . -f deploydocker/Dockerfile.winedeploy.arch.latest -t wineappimage.arch.latest

after_success:
  - mkdir apps

  # ubuntu bionic
  # - docker run --rm -v $(pwd)/apps:/tmp/apps -ti wine-stable-appimage.bionic cp Wine-x86_64.AppImage /tmp/apps/Wine-stable-x86_64-bionic.AppImage
  # - docker run --rm -v $(pwd)/apps:/tmp/apps -ti wine-stable-appimage.bionic cp Wine-x86_64.AppImage.zsync /tmp/apps/Wine-stable-x86_64-bionic.AppImage.zsync
  # - docker run --rm -v $(pwd)/apps:/tmp/apps -ti wine-devel-appimage.bionic cp Wine-x86_64.AppImage /tmp/apps/Wine-devel-x86_64-bionic.AppImage
  # - docker run --rm -v $(pwd)/apps:/tmp/apps -ti wine-devel-appimage.bionic cp Wine-x86_64.AppImage.zsync /tmp/apps/Wine-devel-x86_64-bionic.AppImage.zsync
  # - docker run --rm -v $(pwd)/apps:/tmp/apps -ti wine-staging-appimage.bionic cp Wine-x86_64.AppImage /tmp/apps/Wine-staging-x86_64-bionic.AppImage
  # - docker run --rm -v $(pwd)/apps:/tmp/apps -ti wine-staging-appimage.bionic cp Wine-x86_64.AppImage.zsync /tmp/apps/Wine-staging-x86_64-bionic.AppImage.zsync

  # debian buster
  # - docker run --rm -v $(pwd)/apps:/tmp/apps -ti wine-stable-appimage.buster cp Wine-x86_64.AppImage /tmp/apps/Wine-stable-x86_64-buster.AppImage
  # - docker run --rm -v $(pwd)/apps:/tmp/apps -ti wine-stable-appimage.buster cp Wine-x86_64.AppImage.zsync /tmp/apps/Wine-stable-x86_64-buster.AppImage.zsync
  # - docker run --rm -v $(pwd)/apps:/tmp/apps -ti wine-devel-appimage.buster cp Wine-x86_64.AppImage /tmp/apps/Wine-devel-x86_64-buster.AppImage
  # - docker run --rm -v $(pwd)/apps:/tmp/apps -ti wine-devel-appimage.buster cp Wine-x86_64.AppImage.zsync /tmp/apps/Wine-devel-x86_64-buster.AppImage.zsync
  # - docker run --rm -v $(pwd)/apps:/tmp/apps -ti wine-staging-appimage.buster cp Wine-x86_64.AppImage /tmp/apps/Wine-staging-x86_64-buster.AppImage
  # - docker run --rm -v $(pwd)/apps:/tmp/apps -ti wine-staging-appimage.buster cp Wine-x86_64.AppImage.zsync /tmp/apps/Wine-staging-x86_64-buster.AppImage.zsync

  # debian stretch
  # - docker run --rm -v $(pwd)/apps:/tmp/apps -ti wine-stable-appimage.stretch cp Wine-x86_64.AppImage /tmp/apps/Wine-stable-x86_64-stretch.AppImage
  # - docker run --rm -v $(pwd)/apps:/tmp/apps -ti wine-stable-appimage.stretch cp Wine-x86_64.AppImage.zsync /tmp/apps/Wine-stable-x86_64-stretch.AppImage.zsync
  # - docker run --rm -v $(pwd)/apps:/tmp/apps -ti wine-devel-appimage.stretch cp Wine-x86_64.AppImage /tmp/apps/Wine-devel-x86_64-stretch.AppImage
  # - docker run --rm -v $(pwd)/apps:/tmp/apps -ti wine-devel-appimage.stretch cp Wine-x86_64.AppImage.zsync /tmp/apps/Wine-devel-x86_64-stretch.AppImage.zsync
  # - docker run --rm -v $(pwd)/apps:/tmp/apps -ti wine-staging-appimage.stretch cp Wine-x86_64.AppImage /tmp/apps/Wine-staging-x86_64-stretch.AppImage
  # - docker run --rm -v $(pwd)/apps:/tmp/apps -ti wine-staging-appimage.stretch cp Wine-x86_64.AppImage.zsync /tmp/apps/Wine-staging-x86_64-stretch.AppImage.zsync

  # archlinux
  - docker run --rm -v $(pwd)/apps:/tmp/apps -ti wineappimage.arch.latest cp Wine-x86_64.AppImage /tmp/apps/Wine-x86_64-arch.latest.AppImage
  - docker run --rm -v $(pwd)/apps:/tmp/apps -ti wineappimage.arch.latest cp Wine-x86_64.AppImage.zsync /tmp/apps/Wine-x86_64-arch.latest.AppImage.zsync

  # uploadtool
  - wget -c https://github.com/probonopd/uploadtool/raw/master/upload.sh
  - bash upload.sh apps/*

branches:
  except:
    - # Do not build tags that we create when we upload to GitHub Releases
    - /^(?i:continuous)$/
 
env:
  global:
  - secure: TLz4i4FEEBe8rkbLXsrcwERe0gUzP/Hvs54Hdg+lNYfzviq7gqduwTG/sStbID+Hibpr9jSY7wDH4vHJttuR91utozJZSXSjMWGbjUtyIAV0gj2WZ3grK4w5FyEl8eqY6/QqdVMR/5ckCf3bume96Iu9T3RXL+EsIBzxAPXqOYWx0dtot1T7VwVWX+0/+PRdWb6M900gr3w30qdxxbBd1YdJ/Ee+teQ+2Cx1HFsQv2QkWj/3hn8VHatmcjV0SLpv2W/wginpnsiyTDBoP1qTHV1+extn2Rqs49J+LHK9XjzKi9UeoxmoQvBgzpGvWWVcYLUMFon4ifqaNPNzq1uXVaVbo4XTp8PXl6XGgyxaCNjNy+kA2+b2Rvp/8Ue5TyzrQsTkWIpSyPz7SoOOIUBZg+ySE/8v9Hzho7l5Zi3K7AA+irZLq17IDQyFHVy63O2Rje5ID3KFlcUprI+0YF07szshJwf43Kv0XZn/w8RPTPmuFPCKTxpiN4on735FpSHFqXbAVTOgnan9OtOv4desReA1HCbezJsG4xW6Lpu3Ertj1g18otRxZMR+yLU8TPegfrGYP+EpoSVKHGDolm+EgoKP3imTY5hsbIA8YAjiLfuQkJDQrkFx09P4/jHafMXIfB1NfP7WynCoi8J3egLm5rys0YKlWS0Yq4YC22qkmME=
  - secure: OYhWVy0bC2PmaUVEF0ThoQpze9wV71Ou+8c77O+I+MXTEIU1R0l3sIJ4fA/2z+l78oZdMxqlcHAI+KHYK3cIfe4gjTYttpTvkUY3ESc4Yl1KAT8byVBPanc/DOcyihDXnqYotPNhy/SUDMM690wKtbfNZExdSo06MchH/CesBd4njL3S8P3lGpfgSWV1S7iNnheL6HJj+RbJR1YyvZD+eUCYvEoL10J8sHCOD0IksrT9KsuUx5haz0kZ+i5gx4zD6HBG89rSETORdaOs80EC3azhKSBqmfSI5mP/iRSS1zYR8sZcxtAFCD1j25N11RSdErORS7+PFmErZUKInm/dtGKi+Lco+ppt5hNq3Bb0EkEIfBsalczEum3IEywX4o4AxF6M8lKJHTmI2beyd9tdujEnIAbH8BTbFVHTuZAapNrJmob7YtsdalhOuB/qq9CDGZ6CQU38mLIFfiWktNJX+f7d57kLmwnE6VrbntUUx6QGBSIm/HjiH7Hox5d90y/IKHG+zGt7jDCeyd1APf/g3+HQkdCXuY3PeIi9T0VJyGdLpWZ935UxBissG47vR1ukeQGFTBa8m8GpvN2RNCZY+evqcV0RegjFEvdLcSrf7lsi2bF96VOmIhjSFX0k62tTys3zCXIbeswufbVnaR6/IGcLIZgSZ2WJ+nDPMiSdG+k=
